<!DOCTYPE html>
<html>
<head>
<title>Rain's Pokemon Collection</title>
<link rel="shortcut icon" type="image/png" href="favicon.png">
<link rel="stylesheet" href="styles.css">
</head>
<body>
<center>
<h1><table><tr><td><image src="./un2.png" width=64 height=64></td><td>hello!</td></tr></table></h1>

<p>My name is Rain and this is a little webpage I made to document and display my Pokemon collection.<br>More functionality may be added to the page in the future when I possess more motivation and programming skills.<br>I can be reached @ rainown on Discord if you somehow found this and wanted to contact me.<br>Thanks for reading, and have a nice day/night.</p>
<button class=lkb id="button_set7" onclick="document.location='./pogo'">This page contains my main series Pokemon collection. Click here to instead view my Pokemon GO collection.</button><br>

<button id="button_set1" onclick="showTables('set1')"><table><tr><td><image src="./iconf.png" width="32" height="32"></td><td valign="center">Regular Pokemon</td></tr></table></button>
<button id="button_set3" onclick="showTables('set3')"><table><tr><td><image src="./icons.png" width="32" height="32"></td><td valign="center">Special Pokemon</td></tr></table></button>
<button id="button_set4" onclick="showTables('set4')"><table><tr><td><image src="./iconm.png" width="32" height="32"></td></td><td valign="center">Marked Pokemon</td></tr></table></button>
<button id="button_set5" onclick="showTables('set5')"><table><tr><td><image src="./icona.png" width="32" height="32"></td></td><td valign="center">Shiny Alpha Dex</td></tr></table></button>
<button id="button_set6" onclick="showTables('set6')"><table><tr><td><image src="./icone.png" width="32" height="32"></td></td><td valign="center">Event Collection</td></tr></table></button><br>

<button onclick="topFunction()" class="topb" title="Scroll to Top">Scroll To Top</button>

<div id="set1">
<div style="width:90%" align=center class=cplease id="sheetfill"></div>
<p>loading...</p>
</div>

<div id="set3" class="hidden">
<div style="width:90%" align=center class=cplease id="sheetfill3"></div>
<p>loading...</p>
</div>

<div id="set4" class="hidden">
<div style="width:90%" align=center class=cplease id="sheetfill4"></div>
<p>loading...</p>
</div>

<div id="set5" class="hidden">
<div style="width:90%" align=center class=cplease id="sheetfill5"></div>
<p>loading...</p>
</div>

<div id="set6" class="hidden">
<div style="width:90%" align=center class=cplease id="sheetfill6"></div>
<p>loading...</p>
</div>

</center>

<script>
    var currentSet = '';
    var currentButton = '';

    function showTables(setId) {
        if (currentSet !== '') {
            var previousSet = document.getElementById(currentSet);
            previousSet.classList.add('hidden');
        }

        var selectedButton = document.getElementById('button_' + setId);
        selectedButton.classList.add('active');

        if (currentButton !== '') {
            currentButton.classList.remove('active');
        }
        currentButton = document.getElementById('button_' + setId);
        currentButton.classList.add('active');

        var selectedSet = document.getElementById(setId);
        selectedSet.classList.remove('hidden');

        currentSet = setId;
    }

    showTables('set1');

function populateDivWithData(data) {
    const container = document.getElementById('sheetfill');

    container.innerHTML = ''; // Clear previous content

    let content = ''; // Initialize an empty string to accumulate the content

    data.values.forEach(rowData => {
        rowData.forEach(cellData => {
            content += cellData + ' '; // Append each cell's data followed by a space
        });
    });

    container.innerHTML = content.trim(); // Set the accumulated content as the inner HTML of the container
}

function populateDiv3WithData(data) {
    const container = document.getElementById('sheetfill3');

    container.innerHTML = ''; // Clear previous content

    let content = ''; // Initialize an empty string to accumulate the content

    data.values.forEach(rowData => {
        rowData.forEach(cellData => {
            content += cellData + ' '; // Append each cell's data followed by a space
        });
    });

    container.innerHTML = content.trim(); // Set the accumulated content as the inner HTML of the container
}

function populateDiv4WithData(data) {
    const container = document.getElementById('sheetfill4');

    container.innerHTML = ''; // Clear previous content

    let content = ''; // Initialize an empty string to accumulate the content

    data.values.forEach(rowData => {
        rowData.forEach(cellData => {
            content += cellData + ' '; // Append each cell's data followed by a space
        });
    });

    container.innerHTML = content.trim(); // Set the accumulated content as the inner HTML of the container
}

function populateDiv5WithData(data) {
    const container = document.getElementById('sheetfill5');

    container.innerHTML = ''; // Clear previous content

    let content = ''; // Initialize an empty string to accumulate the content

    data.values.forEach(rowData => {
        rowData.forEach(cellData => {
            content += cellData + ' '; // Append each cell's data followed by a space
        });
    });

    container.innerHTML = content.trim(); // Set the accumulated content as the inner HTML of the container
}

function populateDiv6WithData(data) {
    const container = document.getElementById('sheetfill6');

    container.innerHTML = ''; // Clear previous content

    let content = ''; // Initialize an empty string to accumulate the content

    data.values.forEach(rowData => {
        rowData.forEach(cellData => {
            content += cellData + ' '; // Append each cell's data followed by a space
        });
    });

    container.innerHTML = content.trim(); // Set the accumulated content as the inner HTML of the container
}
window.onload = fetchData;

if(document.URL.indexOf("#legendary") >= 0){ 
document.getElementById('button_set3').click();
}
if(document.URL.indexOf("#marked") >= 0){ 
document.getElementById('button_set4').click();
}
if(document.URL.indexOf("#alpha") >= 0){ 
document.getElementById('button_set5').click();
}
if(document.URL.indexOf("#event") >= 0){ 
document.getElementById('button_set6').click();
}

        const SPREADSHEET_ID = "18nZiea5nRIqAA42Q-pQpNYCL3ZreuNUqZ0AxuOsn7FY";
        const API_KEY = "AIzaSyAVF_cJZiGHJm9ImFnK2Ed2S_2Lm_k86Q8";
        const RANGE = "FlawlessRegular!AR1:AR9999";
        const RANGE3 = "LegendaryMythical!AR1:AR9999";
        const RANGE4 = "MarkedShiny!AR1:AR9999";
        const RANGE5 = "ShinyAlpha!AR1:AR9999";
        const RANGE6 = "EventRaid!AR1:AR9999";

function fetchData() {
    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${RANGE}?key=${API_KEY}`)
        .then(response => response.json())
        .then(data => populateDivWithData(data))
        .catch(error => console.error('Error fetching data:', error));

    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${RANGE3}?key=${API_KEY}`)
        .then(response => response.json())
        .then(data => populateDiv3WithData(data))
        .catch(error => console.error('Error fetching data:', error));

    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${RANGE4}?key=${API_KEY}`)
        .then(response => response.json())
        .then(data => populateDiv4WithData(data))
        .catch(error => console.error('Error fetching data:', error));

    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${RANGE5}?key=${API_KEY}`)
        .then(response => response.json())
        .then(data => populateDiv5WithData(data))
        .catch(error => console.error('Error fetching data:', error));

    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${RANGE6}?key=${API_KEY}`)
        .then(response => response.json())
        .then(data => populateDiv6WithData(data))
        .catch(error => console.error('Error fetching data:', error));
}

function topFunction() {
  document.body.scrollTop = 0; // For Safari
  document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
}

</script>

</body>
</html>